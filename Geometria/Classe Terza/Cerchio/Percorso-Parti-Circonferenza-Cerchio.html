<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>La Circonferenza e il Cerchio — Definizioni e Parti</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f5f7fa;color:#2d3748;line-height:1.6;padding-bottom:40px}

/* HEADER */
.header{background:linear-gradient(135deg,#1565c0,#6a1b9a);color:#fff;text-align:center;padding:24px 16px 18px}
.header h1{font-size:1.35rem;font-weight:700;margin-bottom:4px}
.header p{font-size:.85rem;opacity:.9}

/* PROGRESS */
.progress-bar{display:flex;justify-content:center;gap:6px;padding:14px 12px;background:#fff;border-bottom:1px solid #e2e8f0;position:sticky;top:0;z-index:100}
.progress-step{display:flex;align-items:center;gap:4px;font-size:.75rem;color:#a0aec0}
.progress-step .dot{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.8rem;border:2px solid #cbd5e0;color:#a0aec0;background:#fff;transition:all .3s}
.progress-step.active .dot{background:#1565c0;color:#fff;border-color:#1565c0}
.progress-step.done .dot{background:#2e7d32;color:#fff;border-color:#2e7d32}
.progress-step .lbl{display:none}
@media(min-width:580px){.progress-step .lbl{display:inline}}

/* LAYOUT */
.container{max-width:720px;margin:0 auto;padding:0 12px}
.phase{display:none;padding:20px 0}
.phase.visible{display:block}
.phase-title{font-size:1.15rem;font-weight:700;margin-bottom:6px;color:#1a202c}
.phase-instr{font-size:.88rem;color:#718096;margin-bottom:16px;padding:10px 14px;background:#edf2f7;border-radius:8px;border-left:4px solid #1565c0}

/* CARDS — Phase 1 & 2 */
.ecard{background:#fff;border-radius:10px;margin-bottom:10px;box-shadow:0 1px 4px rgba(0,0,0,.08);overflow:hidden;cursor:pointer;border:2px solid #e2e8f0;transition:border-color .3s}
.ecard.opened{border-color:#2e7d32;cursor:default}
.ecard-head{display:flex;align-items:center;padding:14px 16px;gap:12px;user-select:none;-webkit-tap-highlight-color:transparent}
.ecard-head .ic{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1rem;flex-shrink:0;transition:all .3s}
.p1 .ic{background:#e3f2fd;color:#1565c0}
.p1.opened .ic{background:#e8f5e9;color:#2e7d32}
.p2 .ic{background:#f3e5f5;color:#6a1b9a}
.p2.opened .ic{background:#e8f5e9;color:#2e7d32}
.ecard-head .ttl{font-weight:600;font-size:.95rem;flex:1}
.ecard-head .chk{font-size:1.1rem;color:#cbd5e0;transition:color .3s}
.ecard.opened .chk{color:#2e7d32}
.ecard-body{display:none;padding:0 16px 16px;font-size:.9rem;line-height:1.7;border-top:1px solid #edf2f7}
.ecard.opened .ecard-body{display:block}
.hl-def{background:#e3f2fd;border-left:3px solid #1565c0;padding:10px 14px;border-radius:0 6px 6px 0;margin:8px 0}
.hl-form{background:#f3e5f5;border-left:3px solid #6a1b9a;padding:10px 14px;border-radius:0 6px 6px 0;margin:8px 0}
.hl-note{background:#fff8e1;border-left:3px solid #ffb300;padding:10px 14px;border-radius:0 6px 6px 0;margin:8px 0}
.hl-ex{background:#e8f5e9;border-left:3px solid #2e7d32;padding:10px 14px;border-radius:0 6px 6px 0;margin:8px 0}

/* CONCEPT CARDS — Phase 3 */
.ccard{background:#fff;border-radius:10px;margin-bottom:10px;box-shadow:0 1px 4px rgba(0,0,0,.08);overflow:hidden;cursor:pointer;border:2px solid #e2e8f0;transition:border-color .3s}
.ccard.opened{border-color:#ff9800;cursor:default}
.ccard-head{display:flex;align-items:center;padding:14px 16px;gap:12px;user-select:none;-webkit-tap-highlight-color:transparent}
.ccard-head .ic{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1rem;flex-shrink:0;background:#fff3e0;color:#ff9800}
.ccard.opened .ccard-head .ic{background:#e8f5e9;color:#2e7d32}
.ccard-head .ttl{font-weight:600;font-size:.95rem;flex:1}
.ccard-head .chk{font-size:1.1rem;color:#cbd5e0;transition:color .3s}
.ccard.opened .chk{color:#2e7d32}
.ccard-body{display:none;padding:0 16px 16px;font-size:.9rem;line-height:1.7;border-top:1px solid #edf2f7}
.ccard.opened .ccard-body{display:block}

/* QUIZ — Phase 4 */
.qq{background:#fff;border-radius:10px;margin-bottom:14px;padding:18px;box-shadow:0 1px 4px rgba(0,0,0,.08);border:2px solid #e2e8f0;transition:border-color .3s}
.qq.correct{border-color:#2e7d32}.qq.wrong{border-color:#e53935}.qq.unanswered{border-color:#ff9800}
.qq .cat{font-size:.7rem;text-transform:uppercase;letter-spacing:.5px;color:#6a1b9a;font-weight:600;margin-bottom:6px}
.qq .qtxt{font-weight:600;margin-bottom:12px;font-size:.95rem}
.qopt{display:flex;align-items:flex-start;gap:10px;padding:10px 12px;margin-bottom:4px;border-radius:8px;cursor:pointer;border:1px solid #e2e8f0;transition:all .2s;-webkit-tap-highlight-color:transparent}
.qopt:hover{background:#f7fafc}
.qopt.sel{background:#e3f2fd;border-color:#1565c0}
.qopt.locked{pointer-events:none;opacity:.85}
.qopt.c-ans{background:#e8f5e9;border-color:#2e7d32}
.qopt.w-ans{background:#ffebee;border-color:#e53935}
.qopt input{margin-top:3px;flex-shrink:0}
.qopt label{cursor:pointer;font-size:.9rem}
.qfb{display:none;margin-top:10px;padding:10px 14px;border-radius:6px;font-size:.85rem;line-height:1.5}
.qfb.show{display:block}
.qfb.fb-ok{background:#e8f5e9;color:#1b5e20}
.qfb.fb-ko{background:#ffebee;color:#b71c1c}

/* PHASE 5 */
.rev-area{border-radius:10px;margin-bottom:14px;padding:18px;box-shadow:0 1px 4px rgba(0,0,0,.08)}
.rev-area.ok{background:#e8f5e9;border:2px solid #2e7d32}
.rev-area.ko{background:#fff8e1;border:2px solid #ffb300}
.rev-area .badge{display:inline-block;padding:3px 10px;border-radius:12px;font-size:.75rem;font-weight:700;margin-bottom:8px}
.rev-area.ok .badge{background:#2e7d32;color:#fff}
.rev-area.ko .badge{background:#ffb300;color:#3e2723}
.rev-area h3{font-size:1rem;margin-bottom:8px}
.rev-area .rcont{font-size:.9rem;line-height:1.7}
.score-box{text-align:center;padding:20px;background:#fff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.1);margin-bottom:20px}
.score-box .sn{font-size:2.4rem;font-weight:800}
.score-box .sl{font-size:.9rem;color:#718096}

/* BUTTONS */
.brow{display:flex;gap:10px;margin-top:20px;flex-wrap:wrap}
.btn{padding:12px 24px;border-radius:8px;font-size:.95rem;font-weight:600;border:none;cursor:pointer;transition:all .2s;text-align:center;flex:1;min-width:140px;-webkit-tap-highlight-color:transparent}
.btn:active{transform:scale(.97)}
.btn-p{background:#1565c0;color:#fff}.btn-p:hover{background:#0d47a1}.btn-p:disabled{background:#90caf9;cursor:not-allowed}
.btn-s{background:#78909c;color:#fff}.btn-s:hover{background:#546e7a}
.btn-g{background:#2e7d32;color:#fff}.btn-g:hover{background:#1b5e20}
.btn-w{background:#ff9800;color:#fff}.btn-w:hover{background:#f57c00}
.counter{text-align:center;font-size:.85rem;color:#718096;margin-top:10px}
.alert{display:none;padding:12px 16px;border-radius:8px;margin-bottom:14px;font-size:.88rem;font-weight:500;background:#fff3e0;color:#e65100;border:1px solid #ffcc02}
.alert.show{display:block}

/* PRINT */
@media print{[id^="phase"]{display:none!important}#phase5{display:block!important}.header,.progress-bar,.brow,.btn,.score-box{display:none!important}body{background:#fff;padding:0}.container{max-width:100%;padding:0 20px}.rev-area{break-inside:avoid;box-shadow:none;border-width:1px}}
@media(max-width:480px){.header h1{font-size:1.1rem}.ecard-head,.ccard-head{padding:12px 14px}.qq{padding:14px}.btn{padding:12px 16px;font-size:.88rem}}
</style>
</head>
<body>

<div class="header">
  <h1>La Circonferenza e il Cerchio</h1>
  <p>Definizioni e parti — Percorso interattivo</p>
</div>

<div class="progress-bar" id="pbar">
  <div class="progress-step active" data-s="1"><span class="dot">1</span><span class="lbl">Cfr.</span></div>
  <div class="progress-step" data-s="2"><span class="dot">2</span><span class="lbl">Cerchio</span></div>
  <div class="progress-step" data-s="3"><span class="dot">3</span><span class="lbl">Concetti</span></div>
  <div class="progress-step" data-s="4"><span class="dot">4</span><span class="lbl">Verifica</span></div>
  <div class="progress-step" data-s="5"><span class="dot">5</span><span class="lbl">Ripasso</span></div>
</div>

<div class="container">

<!-- ============================================================ -->
<!-- FASE 1 — LA CIRCONFERENZA                                    -->
<!-- ============================================================ -->
<div class="phase visible" id="phase1">
  <h2 class="phase-title">Fase 1 — La Circonferenza</h2>
  <div class="phase-instr">Clicca su ogni elemento per scoprirne le proprietà. Devi aprirli tutti per proseguire.</div>

  <div class="ecard p1" data-id="1a" onclick="openE(this)">
    <div class="ecard-head"><span class="ic">◎</span><span class="ttl">Definizione di Circonferenza</span><span class="chk">○</span></div>
    <div class="ecard-body">
      <div class="hl-def">La <strong>circonferenza</strong> è una linea chiusa formata da tutti i punti del piano <strong>equidistanti</strong> da un punto fisso detto <strong>centro</strong> (O).</div>
      <p>La circonferenza è un ente <strong>unidimensionale</strong> (1D): ha una lunghezza, ma <strong>non</strong> una superficie.</p>
      <div class="hl-note"><strong>Attenzione:</strong> non va confusa con il <strong>cerchio</strong>, che è la superficie racchiusa dalla circonferenza (2D). Circonferenza e cerchio <strong>non sono sinonimi</strong>.</div>
    </div>
  </div>

  <div class="ecard p1" data-id="1b" onclick="openE(this)">
    <div class="ecard-head"><span class="ic">→</span><span class="ttl">Il Raggio</span><span class="chk">○</span></div>
    <div class="ecard-body">
      <div class="hl-def">Il <strong>raggio</strong> (\(r\)) è la distanza tra il centro \(O\) e un qualsiasi punto della circonferenza.</div>
      <p>I raggi di una stessa circonferenza sono <strong>infiniti</strong> e tutti <strong>congruenti</strong>: ogni punto della circonferenza è alla stessa distanza dal centro.</p>
      <p>Il raggio si indica con la lettera <strong>\(r\)</strong>. Il centro si indica con la lettera <strong>\(O\)</strong> (come il centro del compasso).</p>
    </div>
  </div>

  <div class="ecard p1" data-id="1c" onclick="openE(this)">
    <div class="ecard-head"><span class="ic">⌒</span><span class="ttl">Corda e Arco</span><span class="chk">○</span></div>
    <div class="ecard-body">
      <div class="hl-def">La <strong>corda</strong> è un segmento che unisce due punti della circonferenza (\(\overline{AB}\)).</div>
      <p>Ogni corda divide la circonferenza in due <strong>archi</strong>:</p>
      <ul style="margin:6px 0 6px 20px">
        <li><strong>Arco minore</strong> \(\overset{\frown}{AB}\)</li>
        <li><strong>Arco maggiore</strong> \(\overset{\frown}{ACB}\)</li>
      </ul>
      <p>Si dice che gli archi <strong>sottendono</strong> la corda (e viceversa).</p>
    </div>
  </div>

  <div class="ecard p1" data-id="1d" onclick="openE(this)">
    <div class="ecard-head"><span class="ic">⊘</span><span class="ttl">Diametro e Semicirconferenza</span><span class="chk">○</span></div>
    <div class="ecard-body">
      <div class="hl-def">Il <strong>diametro</strong> (\(d\)) è la <strong>corda più lunga</strong>: passa per il centro e divide la circonferenza in due <strong>semicirconferenze</strong> congruenti.</div>
      <p>La relazione fondamentale tra diametro e raggio è:</p>
      <div class="hl-form">$$d = 2 \cdot r \qquad \longleftrightarrow \qquad r = \frac{d}{2}$$</div>
      <div class="hl-note"><strong>Ricorda:</strong> il diametro è <strong>sempre il doppio</strong> del raggio. Se conosci uno, trovi immediatamente l'altro.</div>
    </div>
  </div>

  <div class="counter" id="cnt1">Elementi aperti: 0 / 4</div>
  <div class="brow">
    <button class="btn btn-p" id="bN1" disabled onclick="go(2)">Vai alla Fase 2 →</button>
  </div>
</div>

<!-- ============================================================ -->
<!-- FASE 2 — IL CERCHIO                                          -->
<!-- ============================================================ -->
<div class="phase" id="phase2">
  <h2 class="phase-title">Fase 2 — Il Cerchio</h2>
  <div class="phase-instr">Clicca su ogni elemento per scoprirne le proprietà. Devi aprirli tutti per proseguire.</div>

  <div class="ecard p2" data-id="2a" onclick="openE(this)">
    <div class="ecard-head"><span class="ic">●</span><span class="ttl">Definizione di Cerchio</span><span class="chk">○</span></div>
    <div class="ecard-body">
      <div class="hl-def">Il <strong>cerchio</strong> è la porzione di piano delimitata da una circonferenza (compresa).</div>
      <p>È un ente <strong>bidimensionale</strong> (2D): è una <strong>superficie</strong> e si misura in unità di area (cm², m², ...).</p>
      <p>Il centro e il raggio del cerchio <strong>coincidono</strong> con quelli della sua circonferenza.</p>
    </div>
  </div>

  <div class="ecard p2" data-id="2b" onclick="openE(this)">
    <div class="ecard-head"><span class="ic">◑</span><span class="ttl">Semicerchio</span><span class="chk">○</span></div>
    <div class="ecard-body">
      <div class="hl-def">Il <strong>semicerchio</strong> è ciascuna delle due parti in cui il <strong>diametro</strong> divide il cerchio.</div>
      <p>I due semicerchi sono <strong>congruenti</strong>.</p>
      <div class="hl-note"><strong>Nota:</strong> il diametro divide sia la circonferenza (in 2 semicirconferenze) sia il cerchio (in 2 semicerchi).</div>
    </div>
  </div>

  <div class="ecard p2" data-id="2c" onclick="openE(this)">
    <div class="ecard-head"><span class="ic">◔</span><span class="ttl">Settore Circolare</span><span class="chk">○</span></div>
    <div class="ecard-body">
      <div class="hl-def">Il <strong>settore circolare</strong> è la parte di cerchio delimitata da <strong>due raggi</strong> e dall'<strong>arco</strong> da essi compreso.</div>
      <p>Due raggi individuano sempre due settori circolari: uno <strong>minore</strong> e uno <strong>maggiore</strong>.</p>
      <div class="hl-ex">Pensa a una <strong>fetta di torta</strong>: è delimitata da due tagli (= raggi) e dal bordo della torta (= arco).</div>
    </div>
  </div>

  <div class="ecard p2" data-id="2d" onclick="openE(this)">
    <div class="ecard-head"><span class="ic">◓</span><span class="ttl">Segmento Circolare</span><span class="chk">○</span></div>
    <div class="ecard-body">
      <div class="hl-def">Il <strong>segmento circolare</strong> è la parte di cerchio delimitata da una <strong>corda</strong> (diversa dal diametro) e dall'<strong>arco</strong> corrispondente.</div>
      <p>La corda \(\overline{AB}\) costituisce la <strong>base</strong> del segmento circolare.</p>
      <p>Una corda individua due segmenti circolari: uno <strong>minore</strong> e uno <strong>maggiore</strong>.</p>
    </div>
  </div>

  <div class="ecard p2" data-id="2e" onclick="openE(this)">
    <div class="ecard-head"><span class="ic">◉</span><span class="ttl">Corona Circolare</span><span class="chk">○</span></div>
    <div class="ecard-body">
      <div class="hl-def">La <strong>corona circolare</strong> è la porzione di piano compresa tra due <strong>circonferenze concentriche</strong> (stesso centro, raggi diversi).</div>
      <p>Se \(R\) è il raggio maggiore e \(r\) il raggio minore:</p>
      <div class="hl-form">$$A_{\text{corona}} = \pi \cdot R^{2} - \pi \cdot r^{2} = \pi \cdot (R^{2} - r^{2})$$</div>
      <div class="hl-note"><strong>Concentriche</strong> = stesso centro, raggi diversi. La formula si legge: area del cerchio grande meno area del cerchio piccolo.</div>
    </div>
  </div>

  <div class="counter" id="cnt2">Elementi aperti: 0 / 5</div>
  <div class="brow">
    <button class="btn btn-s" onclick="go(1)">← Fase 1</button>
    <button class="btn btn-p" id="bN2" disabled onclick="go(3)">Vai alla Fase 3 →</button>
  </div>
</div>

<!-- ============================================================ -->
<!-- FASE 3 — CONCETTI CHIAVE                                     -->
<!-- ============================================================ -->
<div class="phase" id="phase3">
  <h2 class="phase-title">Fase 3 — Concetti Chiave</h2>
  <div class="phase-instr">Apri tutte le schede per consolidare i concetti fondamentali, poi passa alla verifica.</div>

  <div class="ccard" data-id="3a" onclick="openC(this)">
    <div class="ccard-head"><span class="ic">1</span><span class="ttl">Circonferenza e cerchio: la differenza fondamentale</span><span class="chk">○</span></div>
    <div class="ccard-body">
      <p>La <strong>circonferenza</strong> è la <strong>linea</strong> (1D): misura una lunghezza.</p>
      <p>Il <strong>cerchio</strong> è la <strong>superficie</strong> (2D): misura un'area.</p>
      <p>Non sono sinonimi. Il cerchio <em>include</em> la circonferenza come bordo, ma è l'intera regione interna.</p>
    </div>
  </div>

  <div class="ccard" data-id="3b" onclick="openC(this)">
    <div class="ccard-head"><span class="ic">2</span><span class="ttl">Raggio, diametro e la relazione d = 2r</span><span class="chk">○</span></div>
    <div class="ccard-body">
      <p>Il <strong>raggio</strong> collega il centro a un punto della circonferenza. I raggi sono tutti <strong>congruenti</strong>.</p>
      <p>Il <strong>diametro</strong> è la corda più lunga: passa per il centro e vale il <strong>doppio del raggio</strong>.</p>
      <p>Relazione: \(d = 2r\) e \(r = \dfrac{d}{2}\). Se conosci uno, trovi immediatamente l'altro.</p>
    </div>
  </div>

  <div class="ccard" data-id="3c" onclick="openC(this)">
    <div class="ccard-head"><span class="ic">3</span><span class="ttl">Corda, arco e il verbo «sottendere»</span><span class="chk">○</span></div>
    <div class="ccard-body">
      <p>Una <strong>corda</strong> è un segmento che unisce due punti sulla circonferenza. L'<strong>arco</strong> è la porzione di circonferenza tra quei due punti.</p>
      <p>Ogni corda divide la circonferenza in arco <strong>minore</strong> e arco <strong>maggiore</strong>.</p>
      <p>Il diametro è un caso speciale di corda: la corda <strong>massima</strong>, che passa per il centro.</p>
    </div>
  </div>

  <div class="ccard" data-id="3d" onclick="openC(this)">
    <div class="ccard-head"><span class="ic">4</span><span class="ttl">Le parti del cerchio: come distinguerle</span><span class="chk">○</span></div>
    <div class="ccard-body">
      <p><strong>Semicerchio:</strong> delimitato dal diametro → 2 parti congruenti.</p>
      <p><strong>Settore circolare:</strong> delimitato da 2 raggi + arco → come una «fetta».</p>
      <p><strong>Segmento circolare:</strong> delimitato da 1 corda + arco → la corda non è il diametro.</p>
      <p><strong>Corona circolare:</strong> tra 2 circonferenze concentriche → \(A = \pi(R^{2} - r^{2})\).</p>
      <p>Il trucco per ricordare: il <strong>settore</strong> ha i raggi (2 tagli dal centro), il <strong>segmento</strong> ha la corda (1 taglio diretto).</p>
    </div>
  </div>

  <div class="counter" id="cnt3">Schede aperte: 0 / 4</div>
  <div class="brow">
    <button class="btn btn-s" onclick="go(2)">← Fase 2</button>
    <button class="btn btn-p" id="bN3" disabled onclick="go(4)">Vai alla Verifica →</button>
  </div>
</div>

<!-- ============================================================ -->
<!-- FASE 4 — VERIFICA                                            -->
<!-- ============================================================ -->
<div class="phase" id="phase4">
  <h2 class="phase-title">Fase 4 — Verifica</h2>
  <div class="phase-instr">Rispondi a tutte le domande, poi premi «Verifica Risposte».</div>
  <div class="alert" id="qAlert"></div>

  <!-- Q1 -->
  <div class="qq" id="q1" data-area="cfr" data-correct="2">
    <div class="cat">La Circonferenza</div>
    <div class="qtxt">1. Che cos'è la circonferenza?</div>
    <div class="qopt" onclick="sel(this,'q1',0)"><input type="radio" name="q1"><label>La superficie racchiusa da una linea curva chiusa</label></div>
    <div class="qopt" onclick="sel(this,'q1',1)"><input type="radio" name="q1"><label>Un segmento che collega due punti equidistanti</label></div>
    <div class="qopt" onclick="sel(this,'q1',2)"><input type="radio" name="q1"><label>Una linea chiusa formata da tutti i punti equidistanti da un centro</label></div>
    <div class="qopt" onclick="sel(this,'q1',3)"><input type="radio" name="q1"><label>Un ente bidimensionale che si misura in cm²</label></div>
    <div class="qfb" id="fb-q1"></div>
  </div>

  <!-- Q2 -->
  <div class="qq" id="q2" data-area="cfr" data-correct="1">
    <div class="cat">La Circonferenza</div>
    <div class="qtxt">2. I raggi di una stessa circonferenza sono:</div>
    <div class="qopt" onclick="sel(this,'q2',0)"><input type="radio" name="q2"><label>Finiti e di lunghezza diversa</label></div>
    <div class="qopt" onclick="sel(this,'q2',1)"><input type="radio" name="q2"><label>Infiniti e tutti congruenti</label></div>
    <div class="qopt" onclick="sel(this,'q2',2)"><input type="radio" name="q2"><label>Due: uno per il diametro e uno per la corda</label></div>
    <div class="qopt" onclick="sel(this,'q2',3)"><input type="radio" name="q2"><label>Infiniti ma di lunghezza diversa</label></div>
    <div class="qfb" id="fb-q2"></div>
  </div>

  <!-- Q3 -->
  <div class="qq" id="q3" data-area="cfr" data-correct="0">
    <div class="cat">La Circonferenza</div>
    <div class="qtxt">3. La corda è:</div>
    <div class="qopt" onclick="sel(this,'q3',0)"><input type="radio" name="q3"><label>Un segmento che unisce due punti della circonferenza</label></div>
    <div class="qopt" onclick="sel(this,'q3',1)"><input type="radio" name="q3"><label>Un segmento che parte dal centro e arriva alla circonferenza</label></div>
    <div class="qopt" onclick="sel(this,'q3',2)"><input type="radio" name="q3"><label>La porzione di circonferenza tra due punti</label></div>
    <div class="qopt" onclick="sel(this,'q3',3)"><input type="radio" name="q3"><label>Sinonimo di diametro</label></div>
    <div class="qfb" id="fb-q3"></div>
  </div>

  <!-- Q4 -->
  <div class="qq" id="q4" data-area="cfr" data-correct="3">
    <div class="cat">La Circonferenza</div>
    <div class="qtxt">4. Il diametro è:</div>
    <div class="qopt" onclick="sel(this,'q4',0)"><input type="radio" name="q4"><label>La corda più corta</label></div>
    <div class="qopt" onclick="sel(this,'q4',1)"><input type="radio" name="q4"><label>Uguale al raggio</label></div>
    <div class="qopt" onclick="sel(this,'q4',2)"><input type="radio" name="q4"><label>La metà del raggio</label></div>
    <div class="qopt" onclick="sel(this,'q4',3)"><input type="radio" name="q4"><label>La corda più lunga, che passa per il centro</label></div>
    <div class="qfb" id="fb-q4"></div>
  </div>

  <!-- Q5 -->
  <div class="qq" id="q5" data-area="cfr" data-correct="1">
    <div class="cat">La Circonferenza</div>
    <div class="qtxt">5. Se \(d = 18\) cm, quanto vale il raggio?</div>
    <div class="qopt" onclick="sel(this,'q5',0)"><input type="radio" name="q5"><label>36 cm</label></div>
    <div class="qopt" onclick="sel(this,'q5',1)"><input type="radio" name="q5"><label>9 cm</label></div>
    <div class="qopt" onclick="sel(this,'q5',2)"><input type="radio" name="q5"><label>18 cm</label></div>
    <div class="qopt" onclick="sel(this,'q5',3)"><input type="radio" name="q5"><label>6 cm</label></div>
    <div class="qfb" id="fb-q5"></div>
  </div>

  <!-- Q6 -->
  <div class="qq" id="q6" data-area="cer" data-correct="1">
    <div class="cat">Il Cerchio</div>
    <div class="qtxt">6. Il cerchio è:</div>
    <div class="qopt" onclick="sel(this,'q6',0)"><input type="radio" name="q6"><label>Una linea curva chiusa (1D)</label></div>
    <div class="qopt" onclick="sel(this,'q6',1)"><input type="radio" name="q6"><label>La porzione di piano delimitata dalla circonferenza (2D)</label></div>
    <div class="qopt" onclick="sel(this,'q6',2)"><input type="radio" name="q6"><label>Un sinonimo di circonferenza</label></div>
    <div class="qopt" onclick="sel(this,'q6',3)"><input type="radio" name="q6"><label>Un segmento circolare</label></div>
    <div class="qfb" id="fb-q6"></div>
  </div>

  <!-- Q7 -->
  <div class="qq" id="q7" data-area="cer" data-correct="2">
    <div class="cat">Il Cerchio</div>
    <div class="qtxt">7. Il settore circolare è delimitato da:</div>
    <div class="qopt" onclick="sel(this,'q7',0)"><input type="radio" name="q7"><label>Una corda e un arco</label></div>
    <div class="qopt" onclick="sel(this,'q7',1)"><input type="radio" name="q7"><label>Il diametro</label></div>
    <div class="qopt" onclick="sel(this,'q7',2)"><input type="radio" name="q7"><label>Due raggi e l'arco compreso</label></div>
    <div class="qopt" onclick="sel(this,'q7',3)"><input type="radio" name="q7"><label>Due circonferenze concentriche</label></div>
    <div class="qfb" id="fb-q7"></div>
  </div>

  <!-- Q8 -->
  <div class="qq" id="q8" data-area="cer" data-correct="0">
    <div class="cat">Il Cerchio</div>
    <div class="qtxt">8. Il segmento circolare è delimitato da:</div>
    <div class="qopt" onclick="sel(this,'q8',0)"><input type="radio" name="q8"><label>Una corda (diversa dal diametro) e l'arco corrispondente</label></div>
    <div class="qopt" onclick="sel(this,'q8',1)"><input type="radio" name="q8"><label>Due raggi e l'arco compreso</label></div>
    <div class="qopt" onclick="sel(this,'q8',2)"><input type="radio" name="q8"><label>Il diametro</label></div>
    <div class="qopt" onclick="sel(this,'q8',3)"><input type="radio" name="q8"><label>Due circonferenze concentriche</label></div>
    <div class="qfb" id="fb-q8"></div>
  </div>

  <!-- Q9 -->
  <div class="qq" id="q9" data-area="cer" data-correct="3">
    <div class="cat">Il Cerchio</div>
    <div class="qtxt">9. La corona circolare è la zona compresa tra:</div>
    <div class="qopt" onclick="sel(this,'q9',0)"><input type="radio" name="q9"><label>Una corda e un arco</label></div>
    <div class="qopt" onclick="sel(this,'q9',1)"><input type="radio" name="q9"><label>Due raggi e un arco</label></div>
    <div class="qopt" onclick="sel(this,'q9',2)"><input type="radio" name="q9"><label>Due diametri perpendicolari</label></div>
    <div class="qopt" onclick="sel(this,'q9',3)"><input type="radio" name="q9"><label>Due circonferenze concentriche</label></div>
    <div class="qfb" id="fb-q9"></div>
  </div>

  <!-- Q10 -->
  <div class="qq" id="q10" data-area="cer" data-correct="2">
    <div class="cat">Il Cerchio</div>
    <div class="qtxt">10. Quale tra queste affermazioni è corretta?</div>
    <div class="qopt" onclick="sel(this,'q10',0)"><input type="radio" name="q10"><label>Il semicerchio è delimitato da una corda qualsiasi</label></div>
    <div class="qopt" onclick="sel(this,'q10',1)"><input type="radio" name="q10"><label>Il settore circolare è delimitato da una corda e un arco</label></div>
    <div class="qopt" onclick="sel(this,'q10',2)"><input type="radio" name="q10"><label>Il semicerchio è delimitato dal diametro e i due semicerchi sono congruenti</label></div>
    <div class="qopt" onclick="sel(this,'q10',3)"><input type="radio" name="q10"><label>Il segmento circolare è delimitato da due raggi</label></div>
    <div class="qfb" id="fb-q10"></div>
  </div>

  <div class="brow">
    <button class="btn btn-s" onclick="go(3)">← Fase 3</button>
    <button class="btn btn-g" id="bVer" onclick="verify()">Verifica Risposte</button>
  </div>
</div>

<!-- ============================================================ -->
<!-- FASE 5 — RIPASSO                                             -->
<!-- ============================================================ -->
<div class="phase" id="phase5">
  <h2 class="phase-title">Fase 5 — Ripasso Personalizzato</h2>
  <div id="scoreCont"></div>
  <div id="revCont"></div>
  <div class="brow">
    <button class="btn btn-s" onclick="go(4)">← Rivedi Errori</button>
    <button class="btn btn-w" onclick="window.print()">Stampa Ripasso</button>
    <button class="btn btn-p" onclick="restart()">Ricomincia</button>
  </div>
</div>

</div>

<script>
/* ===== STATE ===== */
const S={phase:1,op:{p1:new Set,p2:new Set,p3:new Set},tot:{p1:4,p2:5,p3:4},ans:{},locked:false};

/* ===== FEEDBACKS ===== */
const FB={
q1:{ok:"Esatto! La circonferenza è la linea curva (1D) formata dai punti equidistanti dal centro.",ko:"La circonferenza è una linea (1D), non una superficie. È formata da tutti i punti equidistanti dal centro."},
q2:{ok:"Esatto! I raggi sono infiniti e tutti congruenti: ogni punto della circonferenza è alla stessa distanza dal centro.",ko:"I raggi sono infiniti (puoi tracciarne quanti vuoi) e tutti congruenti (stessa lunghezza)."},
q3:{ok:"Esatto! La corda è un segmento che unisce due punti sulla circonferenza.",ko:"La corda unisce due punti della circonferenza. Il segmento dal centro è il raggio, non la corda."},
q4:{ok:"Esatto! Il diametro è la corda più lunga e passa per il centro.",ko:"Il diametro è la corda più lunga, passa per il centro e vale d = 2r."},
q5:{ok:"Esatto! r = d/2 = 18/2 = 9 cm.",ko:"Il raggio è la metà del diametro: r = d/2 = 18/2 = 9 cm."},
q6:{ok:"Esatto! Il cerchio è la superficie (2D) delimitata dalla circonferenza.",ko:"Il cerchio è la porzione di piano (superficie, 2D) delimitata dalla circonferenza. Non è sinonimo di circonferenza."},
q7:{ok:"Esatto! Il settore circolare è delimitato da due raggi e dall'arco compreso (come una fetta).",ko:"Il settore circolare è delimitato da 2 raggi + arco. La corda + arco delimita il segmento circolare."},
q8:{ok:"Esatto! Il segmento circolare è delimitato da una corda (≠ diametro) e dall'arco.",ko:"Il segmento circolare è delimitato da una corda (diversa dal diametro) e dall'arco corrispondente."},
q9:{ok:"Esatto! La corona circolare è tra due circonferenze concentriche (stesso centro, raggi diversi).",ko:"La corona circolare è la zona tra due circonferenze concentriche: stesso centro, raggi diversi."},
q10:{ok:"Esatto! Il semicerchio è delimitato dal diametro e i due semicerchi sono congruenti.",ko:"Il semicerchio è delimitato dal diametro (non da una corda qualsiasi). Il settore usa 2 raggi, il segmento usa 1 corda."}
};

/* ===== REVIEW ===== */
const REV={
cfr:{title:"La Circonferenza",
full:"<p><strong>Definizione:</strong> linea chiusa (1D) formata dai punti equidistanti dal centro O. Non è il cerchio (che è 2D).</p><p><strong>Raggio:</strong> distanza centro-punto. Infiniti e tutti congruenti. Simbolo: r.</p><p><strong>Corda:</strong> segmento tra due punti della cfr. Divide la cfr. in arco minore e arco maggiore. Gli archi sottendono la corda.</p><p><strong>Diametro:</strong> la corda più lunga, passa per il centro. Divide la cfr. in 2 semicirconferenze congruenti. Relazione: d = 2r.</p>",
short:"<p>Hai capito le definizioni e gli elementi della circonferenza: raggio, corda, arco, diametro e la relazione d = 2r.</p>"},
cer:{title:"Il Cerchio",
full:"<p><strong>Definizione:</strong> porzione di piano (superficie, 2D) delimitata dalla circonferenza.</p><p><strong>Semicerchio:</strong> delimitato dal diametro → 2 parti congruenti.</p><p><strong>Settore circolare:</strong> delimitato da 2 raggi + arco (come una «fetta»).</p><p><strong>Segmento circolare:</strong> delimitato da 1 corda (≠ diametro) + arco.</p><p><strong>Corona circolare:</strong> tra 2 cfr. concentriche. Formula: A = π(R² − r²).</p><p><strong>Trucco:</strong> il settore ha i raggi (2 tagli dal centro), il segmento ha la corda (1 taglio diretto).</p>",
short:"<p>Hai capito le parti del cerchio e sai distinguere semicerchio, settore, segmento e corona circolare.</p>"}
};

/* ===== NAVIGATION ===== */
function go(n){
  document.querySelectorAll('.phase').forEach(p=>p.classList.remove('visible'));
  document.getElementById('phase'+n).classList.add('visible');
  S.phase=n; updProg();
  window.scrollTo({top:0,behavior:'smooth'});
  if(n===5&&S.locked) genReview();
  rMath('#phase'+n);
}
function updProg(){
  document.querySelectorAll('.progress-step').forEach(s=>{
    const v=+s.dataset.s; s.classList.remove('active','done');
    if(v<S.phase)s.classList.add('done'); else if(v===S.phase)s.classList.add('active');
  });
}

/* ===== ELEMENT TOGGLE ===== */
function openE(c){
  if(c.classList.contains('opened'))return;
  c.classList.add('opened'); c.querySelector('.chk').textContent='✔';
  const id=c.dataset.id; let k,cnt,btn,tot;
  if(id.startsWith('1')){k='p1';cnt='cnt1';btn='bN1';tot=S.tot.p1;}
  else{k='p2';cnt='cnt2';btn='bN2';tot=S.tot.p2;}
  S.op[k].add(id);
  document.getElementById(cnt).textContent='Elementi aperti: '+S.op[k].size+' / '+tot;
  if(S.op[k].size>=tot)document.getElementById(btn).disabled=false;
  rMath(c);
}

/* ===== CONCEPT TOGGLE ===== */
function openC(c){
  if(c.classList.contains('opened'))return;
  c.classList.add('opened'); c.querySelector('.chk').textContent='✔';
  S.op.p3.add(c.dataset.id);
  document.getElementById('cnt3').textContent='Schede aperte: '+S.op.p3.size+' / '+S.tot.p3;
  if(S.op.p3.size>=S.tot.p3)document.getElementById('bN3').disabled=false;
  rMath(c);
}

/* ===== QUIZ ===== */
function sel(o,qid,idx){
  if(S.locked)return;
  const q=document.getElementById(qid);
  q.querySelectorAll('.qopt').forEach(x=>{x.classList.remove('sel');x.querySelector('input').checked=false;});
  o.classList.add('sel'); o.querySelector('input').checked=true; S.ans[qid]=idx;
}

function verify(){
  if(S.locked){go(5);return;}
  const qs=document.querySelectorAll('.qq');
  const miss=[];
  qs.forEach(q=>{if(S.ans[q.id]===undefined)miss.push(q.id);});
  if(miss.length){
    const al=document.getElementById('qAlert');
    al.textContent='Devi rispondere a tutte le domande! Ne mancano '+miss.length+'.';
    al.classList.add('show');
    const f=document.getElementById(miss[0]); f.classList.add('unanswered');
    f.scrollIntoView({behavior:'smooth',block:'center'}); return;
  }
  document.getElementById('qAlert').classList.remove('show');
  S.locked=true; let sc=0;
  S.ar={cfr:{c:0,t:0},cer:{c:0,t:0}};
  qs.forEach(q=>{
    const cor=+q.dataset.correct, area=q.dataset.area, pick=S.ans[q.id], ok=pick===cor;
    const fb=document.getElementById('fb-'+q.id);
    S.ar[area].t++; if(ok){sc++;S.ar[area].c++;q.classList.add('correct');fb.className='qfb show fb-ok';fb.textContent='✔ '+FB[q.id].ok;}
    else{q.classList.add('wrong');fb.className='qfb show fb-ko';fb.textContent='✘ '+FB[q.id].ko;}
    q.querySelectorAll('.qopt').forEach((o,i)=>{o.classList.add('locked');if(i===cor)o.classList.add('c-ans');if(i===pick&&!ok)o.classList.add('w-ans');});
    q.classList.remove('unanswered'); rMath('#'+q.id);
  });
  S.sc=sc; S.tt=qs.length;
  const b=document.getElementById('bVer'); b.textContent='Vai al Ripasso →'; b.className='btn btn-p';
}

/* ===== REVIEW ===== */
function genReview(){
  const sc=document.getElementById('scoreCont'), pct=Math.round(S.sc/S.tt*100);
  let col='#2e7d32'; if(pct<60)col='#e53935'; else if(pct<80)col='#ff9800';
  sc.innerHTML='<div class="score-box"><div class="sn" style="color:'+col+'">'+S.sc+' / '+S.tt+'</div><div class="sl">Risposte corrette ('+pct+'%)</div></div>';
  const rc=document.getElementById('revCont'); rc.innerHTML='';
  ['cfr','cer'].forEach(a=>{
    const r=S.ar[a], ok=r.c===r.t;
    const d=document.createElement('div'); d.className='rev-area '+(ok?'ok':'ko');
    d.innerHTML='<span class="badge">'+(ok?'Hai capito bene':'Da rivedere')+'</span><h3>'+REV[a].title+'</h3><div class="rcont">'+(ok?REV[a].short:REV[a].full)+'</div>';
    rc.appendChild(d);
  });
}

/* ===== RESTART ===== */
function restart(){
  S.phase=1;S.ans={};S.locked=false;S.op.p1.clear();S.op.p2.clear();S.op.p3.clear();
  document.querySelectorAll('.ecard,.ccard').forEach(c=>{c.classList.remove('opened');c.querySelector('.chk').textContent='○';});
  document.getElementById('cnt1').textContent='Elementi aperti: 0 / 4';
  document.getElementById('cnt2').textContent='Elementi aperti: 0 / 5';
  document.getElementById('cnt3').textContent='Schede aperte: 0 / 4';
  ['bN1','bN2','bN3'].forEach(id=>document.getElementById(id).disabled=true);
  const b=document.getElementById('bVer');b.textContent='Verifica Risposte';b.className='btn btn-g';
  document.getElementById('qAlert').classList.remove('show');
  document.querySelectorAll('.qq').forEach(q=>{
    q.classList.remove('correct','wrong','unanswered');
    q.querySelectorAll('.qopt').forEach(o=>{o.classList.remove('sel','locked','c-ans','w-ans');o.querySelector('input').checked=false;});
    q.querySelector('.qfb').className='qfb';
  });
  document.getElementById('scoreCont').innerHTML='';
  document.getElementById('revCont').innerHTML='';
  go(1);
}

/* ===== MATH ===== */
function rMath(target){
  const el=typeof target==='string'?document.querySelector(target):target;
  if(el&&typeof renderMathInElement==='function')renderMathInElement(el,{delimiters:[{left:'$$',right:'$$',display:true},{left:'\\(',right:'\\)',display:false},{left:'\\[',right:'\\]',display:true}],throwOnError:false});
}
document.addEventListener('DOMContentLoaded',()=>rMath(document.body));
</script>
</body>
</html>
